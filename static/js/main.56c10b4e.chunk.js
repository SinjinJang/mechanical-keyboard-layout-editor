(this["webpackJsonpmechanical-keyboard-layout-editor"]=this["webpackJsonpmechanical-keyboard-layout-editor"]||[]).push([[0],{113:function(e,t,n){},114:function(e,t,n){},115:function(e,t,n){},116:function(e,t,n){},118:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),i=n(9),r=n.n(i),l=(n(81),n(82),n(26)),s=n(58),o=15,d=60;function j(e,t){return{x:e*d+o,y:t*d+o}}function u(e,t){return{width:e*d-2,height:t*d-2}}function h(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=0,c=0,i=Object(s.a)(e);try{for(i.s();!(t=i.n()).done;){var r=t.value,l=r.x+r.w;a=l>a?l:a;var o=r.y+r.h;c=o>c?o:c}}catch(j){i.e(j)}finally{i.f()}return{width:n?a:a*d+30,height:n?c:c*d+30}}var b=n(42),g=n.n(b),p=n(59),f=n(44),v=n(67),x=(n(84),n(147)),O=n(151),m=n(158),y=n(159),k=n(161),w=n(157),_=n(154),N=n(155),S=n(156),C=n(60),U=n.n(C),A=n(43),F=n.n(A),B=n(3);var J=function(e){var t=e.layoutState,n=e.selectedState,a=Object(l.b)(!1),c=function(){return Object(f.a)(Object(f.a)({},h(t.get(),!0)),{},{layout:t.get()})},i=function(){var e=Object(p.a)(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.get()){e.next=3;break}return console.log("prevent duplicated click!"),e.abrupt("return");case 3:return a.set(!0),"https://diy-mechanical-keyboard.herokuapp.com",e.next=7,U.a.post("https://diy-mechanical-keyboard.herokuapp.com/model-3d/plate",c());case 7:t=e.sent,n=t.data,F.a.saveAs(new Blob([n],{type:"text/plain; charset=utf-8"}),"plate-model.stl"),a.set(!1);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r=function(e){if(-1!==n.get()&&""!==e.target.value){var a=Number(e.target.value);if("selected-key-width"===e.target.id)t[n.get()].w.set(a);else{if("selected-key-height"!==e.target.id)return void console.log(">>>>> undefined id: "+e.target.id);t[n.get()].h.set(a)}}};return Object(B.jsxs)("div",{children:[a.get()?Object(B.jsx)("div",{className:"loading",children:Object(B.jsx)(x.a,{})}):"",Object(B.jsxs)("div",{className:"editpanel__container",children:[Object(B.jsx)(O.a,{className:"editpanel__item",variant:"outlined",color:"primary",onClick:function(e){e.preventDefault();var a=document.createElement("input");a.setAttribute("type","file"),a.setAttribute("accept",".json"),a.onchange=function(e){var a=new FileReader;a.readAsBinaryString(e.target.files[0]),a.onloadend=function(){var e=JSON.parse(a.result);Object.entries(e.layout).map((function(e){var t=Object(v.a)(e,2),n=(t[0],t[1]);n.w="w"in n?n.w:1,n.h="h"in n?n.h:1})),t.set(e.layout),n.set(-1)}},a.click()},children:"Upload Layout"}),Object(B.jsx)(O.a,{className:"editpanel__item",variant:"outlined",color:"primary",onClick:function(){var e=JSON.stringify(c());F.a.saveAs(new Blob([e],{type:"text/json; charset=utf-8"}),"plate-layout.json")},children:"Download Layout"}),Object(B.jsx)(O.a,{className:"editpanel__item",variant:"outlined",color:"primary",onClick:i,children:"Generate 3D Model"})]}),Object(B.jsxs)("div",{className:"editpanel__container",children:[Object(B.jsx)(m.a,{className:"editpanel__item",children:Object(B.jsx)(y.a,{id:"selected-key-label",label:"Key Label",value:-1===n.get()?"":t[n.get()].label.get(),onChange:function(e){-1!==n.get()&&t[n.get()].label.set(e.target.value)}})}),Object(B.jsxs)(m.a,{className:"editpanel__item",children:[Object(B.jsx)(k.a,{htmlFor:"select-key-width",children:"Width"}),Object(B.jsxs)(w.a,{native:!0,id:"selected-key-width",label:"Width",value:-1===n.get()?"":t[n.get()].w.get(),onChange:r,children:[Object(B.jsx)("option",{value:""}),Object(B.jsx)("option",{value:"1",children:"1U"}),Object(B.jsx)("option",{value:"1.25",children:"1.25U"}),Object(B.jsx)("option",{value:"1.5",children:"1.5U"}),Object(B.jsx)("option",{value:"1.75",children:"1.75U"}),Object(B.jsx)("option",{value:"2",children:"2U"}),Object(B.jsx)("option",{value:"2.25",children:"2.25U"}),Object(B.jsx)("option",{value:"2.75",children:"2.75U"})]})]}),Object(B.jsxs)(m.a,{className:"editpanel__item",children:[Object(B.jsx)(k.a,{htmlFor:"select-key-height",children:"Height"}),Object(B.jsxs)(w.a,{native:!0,id:"selected-key-height",label:"Height",value:-1===n.get()?"":t[n.get()].h.get(),onChange:r,children:[Object(B.jsx)("option",{value:""}),Object(B.jsx)("option",{value:"1",children:"1U"}),Object(B.jsx)("option",{value:"2",children:"2U"})]})]}),Object(B.jsx)(_.a,{className:"editpanel__imageicon",alt:"Add New Switch",onClick:function(){var e=h(t.get(),!0),n=e.width,a=e.height;t.merge([{label:"New Key",x:n,y:Math.max(a-1,0),w:1,h:1}])},children:Object(B.jsx)(N.a,{})}),Object(B.jsx)(_.a,{className:"editpanel__imageicon",alt:"Remove Selected Switch",onClick:function(){-1!==n.get()&&(t[n.get()].set(l.a),n.set(-1))},children:Object(B.jsx)(S.a,{})})]})]})},L=n(66),D=n.n(L);n(113);var M=function(e){var t=e.keyState,n=t.label,a=t.x,c=t.y,i=t.w,r=t.h,l=e.selectedState,s=l.get()===e.seq?"key-switch-selected":"";return Object(B.jsx)(D.a,{grid:[15,15],bounds:{left:o,top:o},position:j(a.get(),c.get()),onDrag:function(e,t){a.set((function(e){return e+t.deltaX/d})),c.set((function(e){return e+t.deltaY/d}))},children:Object(B.jsx)("div",{className:"key-switch ".concat(s),style:u(i.get(),r.get()),onClick:function(){l.set((function(t){return t===e.seq?-1:e.seq}))},children:n.get()})})};var q=function(){var e=Object(l.b)([{label:"New Key",w:1,h:1,x:0,y:0}]),t=Object(l.b)(-1);return Object(B.jsxs)("div",{children:[Object(B.jsx)(J,{layoutState:e,selectedState:t}),Object(B.jsx)("div",{className:"key-plate",style:h(e.get()),children:e.map((function(e,n){return Object(B.jsx)(M,{seq:n,keyState:e,selectedState:t},n)}))})]})};n(114);var H=function(){return Object(B.jsx)("header",{children:Object(B.jsx)("p",{className:"app_name",children:"Mechanical Keyboard Layout Editor"})})};n(115);var K=function(){return Object(B.jsxs)("footer",{className:"footer",children:[Object(B.jsxs)("div",{className:"footer__item",children:["Copyright\xa92021 Sinjin Jang",Object(B.jsx)("br",{}),"All rights reserved."]}),Object(B.jsxs)("div",{className:"footer__item",children:["Get source code of this app:",Object(B.jsx)("br",{}),Object(B.jsx)("a",{href:"https://github.com/SinjinJang/mechanical-keyboard-layout-editor",target:"_blank",children:"mechanical-keyboard-layout-editor on GitHub"})]}),Object(B.jsxs)("div",{className:"footer__item",children:[Object(B.jsx)("a",{href:"https://donaricano.com/mypage/1722367584_zHWZl2",target:"_blank",children:"\ub3c4\ub124\ub9ac\uce74\ub178 \ucee4\ud53c \ud6c4\uc6d0"}),Object(B.jsx)("br",{}),Object(B.jsx)("a",{href:"https://www.buymeacoffee.com/sinjin0",target:"_blank",children:"Buy Me a Coffee"})]})]})};var E=function(){return Object(B.jsxs)("div",{className:"App",children:[Object(B.jsx)(H,{}),Object(B.jsx)(q,{}),Object(B.jsx)(K,{})]})},G=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,162)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),i(e),r(e)}))};n(116),n(117);r.a.render(Object(B.jsx)(c.a.StrictMode,{children:Object(B.jsx)(E,{})}),document.getElementById("root")),G()},81:function(e,t,n){},82:function(e,t,n){},84:function(e,t,n){}},[[118,1,2]]]);
//# sourceMappingURL=main.56c10b4e.chunk.js.map